# Vulnerability Report
## 1. Missing function level access control
### Exposure
Missing function level access control is when you have a resource (object) which can be accessed by a reference then you need to ensure that the user is intended to be there.</p>

Authorize users on all externally facing endpoints to make sure that they are in fact supposed to be there.  This could affect the site by having malicious users trying to gain access in restricted locations.


### Repair
BasketItem.cs contained the vulnerability. We were able to fix the first with the following adjustment(s):



	[Authorize(Roles = "Member")]

### Resources
https://www.owasp.org/index.php/.NET_Security_Cheat_Sheet#Data_Access

## 2.  Sensitive data exposure
### Exposure
Storing encrypted passwords and not using a strong enough hash leaves the users information highly vulnerable to attacks.  If a hacker can gain access and correctly solve the hashing, then they can gain access to other passwords as well.

We fortunately used Microsoft Identity in our site which salts and hashes all sensitive information and stores it in a separate database for this specific reason.  No changes had to be made.

### Repair
Microsoft Identity was used.

### Resources
https://www.owasp.org/index.php/.NET_Security_Cheat_Sheet#Data_Access

## 3.  Account Access Attemps - Active Prevention of Unauthorzied Access
### Exposure
#### A2 Weak Account management
We did not limit the amount of failed attemps and log the login screen for previously created accounts.

### Repair
We could enact a limit on login attempts and time the user out once the max login attempts are reached. Adding login attempt limits and time outs will add a layer against brute force attacks.
```
SELECT [Count] = COUNT(*) FROM dbo.FailedAttempts WHERE Username=@Username AND Occurred > DATEADD(MINUTE, -30, GETDATE())
```

### Resources
https://www.owasp.org/index.php/.NET_Security_Cheat_Sheet#Data_Access
https://www.codeproject.com/Questions/422772/how-to-restrict-user-for-minutes-after-invali
https://stackoverflow.com/questions/15302270/how-do-i-create-a-limit-of-logins-on-my-login-screen 


## 4.  Use of default passwords
### Exposure
#### A5 Security Misconfiguration
We did not use a default password however we use Microsoft Identity to persist the suer password throughout the our site. We could add another layer of secity to the project.

### Repair
Ensure debug and trace are off in production. This can be enforced using web.config transforms:
```
   <compilation xdt:Transform="RemoveAttributes(debug)" />
   <trace enabled="false" xdt:Transform="Replace"/>

DO NOT: Use default passwords

DO: (When using TLS) Redirect a request made over Http to https: In Global.asax.cs:

protected void Application_BeginRequest() {

   #if !DEBUG
           // SECURE: Ensure any request is returned over SSL/TLS in production
           if (!Request.IsLocal && !Context.Request.IsSecureConnection) {
               var redirect = Context.Request.Url.ToString().ToLower(CultureInfo.CurrentCulture).Replace("http:", "https:");
               Response.Redirect(redirect);
           }
   #endif

} 
```

### Resources
https://www.owasp.org/index.php/.NET_Security_Cheat_Sheet#Data_Access
